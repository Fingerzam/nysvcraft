AI For Games II: Loppuraportti
==============================

Ryhmä: 

    Nysvääjät

Jäsenet:

    Nimi                GitHub-tunnus   Opiskelijanumero
    ----------------------------------------------------
    Pekka Mikkola       epokal          013181783
    Juhana Laurinharju  Fingerzam
    Laura Leppänen      Lateks          013302782
    Ilmari Vacklin      wolverian       013182847

Tekoäly(t) ja sen koko versiohistoria on saatavilla osoitteista:

    http://github.com/epokal/nysvcraft
    http://github.com/Fingerzam/nysvcraft
    http://github.com/Lateks/nysvcraft
    http://github.com/wolverian/nysvcraft

Työn jakautuminen
=================

Kaikki ryhmän jäsenet tekivät töitä. Työskentelimme pääasiassa parikoodaten.
Käytimme hajautettua versionhallintaa (git), mikä salli rinnakkaisen
kehitystyön.

Suunnittelu oli pääasiassa Juhanan ja Lauran harteilla, koska he olivat
ainoita ryhmän jäseniä, jotka olivat pelanneet Starcraftia. Pekka oli ainoa
ryhmän jäsen, jolla oli jotain C++-kokemusta. Juhanalla ja Ilmarilla oli 
kokemusta C-kielestä, mikä helpotti C++:n opettelua.

Kuvaus ensimmäisen viikon tekoälystä
====================================

* Rivissä eteneminen
    - Varsinainen muodostelmia kontrolloiva koodi ei koskaan valmistunut, 
      joten ensimmäisen viikon turnauste varten kokoon parsittiin kiireellä
      suoraviivaisempi ratkaisu.
    - Yksiköt siirtyivät alussa riviin, jonka jälkeen ne lähtevät etenemään.
    - Turnauskartta oli lievästi erilainen kuin testauksessa käyttämämme kartta
      (yksiköt aloittivat eri asetelmasta), jonka johdosta muodostelmat hajosivat.
* Perääntyminen
    - Jos vihollisia oli liikaa tai tilanne näytti pahalta niin yksikkö asetettiin
      juoksemaan karkuun.
    - Valintaan vaikutti vihollisjoukkojen lisäksi omien joukkojen lukumäärä ja 
      yksikön tyyppi.
    - Pakenemissuunta valittiin seuraavasti: Kustakin yksikköä kohtaan hyökkävistä 
      vihollisyksiköistä laskettiin yksikön ja vihollisen välinen kulma. Tämän jälkeen 
      kulmista otettiin keskiarvo. Saadusta kulmasta saatiin pakenemissuunta lisäämällä
      siihen pii. 
    - Pakosuunta tuotti ongelmia lähellä seiniä (etenkin toisella viikolla).
* Vihollisen valinta
    - Ensimmäisellä viikolla sekä dragooneilla että zealoteilla valittiin hyökkäyksen
      kohteet samoilla perusteilla.
* Känkkäys
    - Valintakriteerit

Kuvaus toisen viikon tekoälystä
===============================

Korkean tason strategia
-----------------------

* Laajennutaan aggressiivisesti
* Lasketaan, mitä chokepointteja kannattaa vartioida
* Jaetaan puolustajat vartioitaviin chokepointteihin
* Hyökätään kun nähdään vihollisen rakennus
    - Kaikki taisteluyksiköt hyökkäävät
    - Palaavat puolustuspaikoilleen kun ei enää vihollisia näkyvissä
* Kutsutaan kaikki puolustajat hyökkäyksen alla olevaan tukikohtaan
* Kun yksikköraja saavutetaan, hyökätään kaikilla taisteluyksiköillä
  vihollisen aloitustukikohtaan. Kökitään siellä N vuoroa, sitten palataan
  normaaliin strategiaan
    - Piilossa olevat vihollisyksiköt löydetään laajentumisen ansiosta

Rakenne, osat
-------------

* BWSAL
* Laajennettiin omilla Manager-luokilla
    - Expansion
    - Battle
        * Osia ensimmäisen viikon mikrobattlekoodista
        * Uusien yksiköiden ja rakennusten johdosta päätösten tekemislogiikkaa
          muutettiin hiukan.
        * Parametreja ehdittiin jonkin verran parantamaan edellisestä viikosta.
    - Army (Attack)
    - Defense

Miten päätökset tehtiin
-----------------------

* BWSAL (joka käyttää BWTA:ta) päätti rakennusten paikat
* ExpansionManager päätti minne laajennutaan seuraavaksi
    - TODO: Juhana kertoo miten
* Battle
    - Dragoon, zealot ja probe -yksiköiden toiminta taistelussa
      päätettiin oman yksikön tyypin ja vastustajien yksiköiden tyyppien
      ja lukumäärän perusteella. Olisi voinut olla hiotumpikin: mm. probet oli
      helppo houkutella alussa järjettömään hyökkäykseen vastustajan tukikohtaan.
    - Autetaan kaveria jos itsellä vähän hipareja
    - Heikoin joka on rangessa
    - Muuten lähin
* Army
    - (Olisi pitänyt olla kaksi erillistä Manageria -Ilmari)
    - Hoiti hyökkäyksen ja paniikkipuolustuksen
        * Paniikki: vihollisen taisteluyksikkö N etäisyydellä omasta
          rakennuksesta (vai Nexuksesta?)
        * Hyökkäys kun nähdään vihollisen rakennus (myös rakenteilla oleva)
* Defense
    - Yksikköjen asettelu (vartiointi)

Mikä meni pieleen
=================

* BWSAL olikin kasa paskaa
    - Olisi pitänyt koodata itse uudestaan mm. prioriteettijärjestelmä ja
      InformationManager
    - Buginen
* Toinen viikko lähti hitaasti käyntiin
* Ensimmäisellä viikolla puolet ryhmästä koodasi muodostelmakoodia joka ei
  valmistunut ajoissa. Tehtiin yksinkertainen rivissä eteneminen viimeisenä
  iltana korvikkeena. Yksinpeliversiossa turnauskartasta (Aleksi!!!!11)
  zealotit aloittivat edestä ja dragoonit takaa; oikeassa versiossa zealotit
  aloittivat ylhäältä ja dragoonit alhaalta (tai toisinpäin TODO). Haittasi
  rivin muodostamista.
* Laajennuttiin hieman liian nopeasti; alkupään zealot rush oli varma tappio
* Probet hyökkäsivät taisteluyksikköjen kimppuun vaikka ei pitänyt (Battle)
* Random-bugeja, ikuinen looppi turnauksessa (omglol bwsal)
* Löydettiin bugi battlekoodista viime hetkillä, viimeinen tunti ennen
  turnausta meni segfaultin etsimiseen (NULL-pointteri)
    - Segfaulttasi silti kerran turnauksessa (loopin lisäksi)

Mitä jäi toteuttamatta
======================

* Muodostelmat (1. vko)
* Chokepointtien priorisointi
* Järkevä rush-targetin valinta (ei ehditty ottaa mukaan)
* Prioriteettijonon korjaus
* Känkkääminen (molemmat vkot)
* Ensimmäisen viikon tekoäly ei osannut etsiä vihollisia kartalta
    - Yksi tasapeli tämän takia: vihollisella yksi zealot, jolla yksi hipari,
      meillä 8 dragoonia jotka jäivät kökkimään vihollisen aloituspaikkaan, 
      kunnes sovittiin tasapeliksi
* Parametrien viilailu sopivaan laajentumistahtiin ja taisteluun

META
====
